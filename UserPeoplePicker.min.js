!function(e){function t(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src","/_layouts/15/"+e),document.getElementsByTagName("head")[0].appendChild(t)}function n(e){var t={};t.PrincipalAccountType="User,DL,SecGroup,SPGroup",t.SearchPrincipalSource=15,t.ResolvePrincipalSource=15,t.AllowMultipleValues=!0,t.MaximumEntitySuggestions=50,t.Width="280px",this.SPClientPeoplePicker_InitStandaloneControlWrapper(e,null,t)}function r(e){var t=e+"_TopSpan",n=null,r=this.SPClientPeoplePicker.SPClientPeoplePickerDict;for(var i in r)if(i==t){n=r[i];break}return n}function i(e){var t=r(e);if(null!=t){for(var n=t.GetAllUserInfo(),i=[],o=0;o<n.length;o++){var a=n[o],l=s(a.Key);i.push(l)}return i}return""}function o(e){var t=r(e);if(null!=t){for(var n=t.GetAllUserInfo(),i="",o=0;o<n.length;o++){var a=n[o];i+=a.DisplayText+";#"}return i}return""}function a(e,t){var n=r(e);null!=n&&t.forEach(function(e){var t=l(e);null!=t&&n.AddUserKeys(t.LoginName,!1)})}function s(t){var n="";return e.ajax({url:_spPageContextInfo.siteAbsoluteUrl+"/_api/web/siteusers(@v)?@v='"+encodeURIComponent(t)+"'",method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(e){n=e.d.Id},error:function(e){console.log(e)}}),n}function l(t){var n="";return e.ajax({url:_spPageContextInfo.siteAbsoluteUrl+"/_api/web/getuserbyid("+t+")",method:"GET",async:!1,headers:{Accept:"application/json; odata=verbose"},success:function(e){n=e.d},error:function(e){console.log(e)}}),n}t("clienttemplates.js"),t("clientforms.js"),t("clientpeoplepicker.js"),t("autofill.js"),e.fn.spPeoplePicker=function(){var t=e(this).attr("id");ExecuteOrDelayUntilScriptLoaded(function(){n(t)},"sp.core.js")},e.fn.GetUserNames=function(){var t=e(this).attr("id"),n=o(t);return n.slice(0,-2)},e.fn.GetUserIDs=function(){var t=e(this).attr("id"),n=i(t);return n},e.fn.SetUserIDs=function(t){if(t.length>0){var n=e(this).attr("id"),r=a(n,t);return r}}}(jQuery);
